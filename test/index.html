<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>cnigma</title>
    <script src="https://cdn.jsdelivr.net/npm/almond@0.3.3/almond.min.js"></script>
    <script src="./cnigma.bundle.js"></script>
  </head>
  <body>
    <h1>Facebook Conceal and Rsa</h1>

    <script>
      const rsaPrivateKey =
        '-----BEGIN PRIVATE KEY-----' +
        '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' +
        'LoNEQDJDagq/hz8rWBXilBFMoYzAjg==' +
        '-----END PRIVATE KEY-----';

      const rsaPublicKey =
        '-----BEGIN PUBLIC KEY-----' +
        'MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA7UV1qGfCtKmM1pBhXWn6' +
        'TMk9tcMZ751+w2/bD4VaeObnlIsmZdgq7fRJva1qKV+8u7MmBhSR/sv7Y2RruqWx' +
        'f0NvQC+6V1OLlz6iqRPuvln1+6+IKFivQV3wMipcg61Wo/ZUA5HuXnkjVeZRB/gA' +
        'RZ6wPc/EJCj5jOvEcitQqhV7fqbqdCmqfpBlvFHtRw/aUftujoQnWzgYK8j+GsBV' +
        '1pKVrIEXooV9GP9X2y7VK7lUYjq63efjCYZwbHykDF9hBn36sKZRG2FQ2Puun+m3' +
        'EbX9BBdQpstxQrUWWcSfN9cyLtIrh/nt6d6y4JTO3DEIKKrz1CS+iyyM2Z8H2Ppf' +
        'qhnyqQz3yQNSctYrEQ7LQDaqS+atcIXdbXToz6H4Lq5RvV24xGFqkUbiZxXSlZIs' +
        'UXDLSePsiX7NS0qZTe3A2SG6n/V+ApFKgj2kqHR+LWtK8VakRhszkUMoKkMXkpIs' +
        '0ngecqSIC/bgvY61ASh9gm+PSk+Ky0vZAakWjdCyWoNzfcq3Ns1d/P1oW/2Kx7q3' +
        'NgDrYdOnlwwfWsdFWlyqjigw9EhE1IVbaPy6DsZY9SdYEszlt3HLuemSHdCfJT7q' +
        'hYcSjyoLeHRavlx9anfes33ALMikm7bBc9leTzu2UVDfEDz8Alg6D4mdPjhaCXvZ' +
        'b7c+zbl3wLj0RX7CFbA+KWECAwEAAQ==' +
        '-----END PUBLIC KEY-----';
    </script>

    <script>
      const { Conceal, Rsa } = require('cnigma');

      const conceal = new Conceal('my-password');
      const rsa = new Rsa(rsaPrivateKey, rsaPublicKey, 'base64');
      const plain = 'hello world @ 2020';

      (async () => {
        console.group('conceal');
        let encrypted = await conceal.encryptStr(plain);
        let decrypted = await conceal.decryptStr(encrypted);
        console.log('plain', plain);
        console.log('encrypted', encrypted);
        console.log('decrypted', decrypted);
        console.groupEnd();

        // sign and verify
        const signed = await rsa.sign(plain);
        const verified = await rsa.verify(plain, signed);

        // encrypt and decrypt string
        encrypted = await rsa.encrypt(plain);
        decrypted = await rsa.decrypt(encrypted);

        console.group('rsa');
        console.log('plain', plain);
        console.log('signed', signed);
        console.log('verified', verified);
        console.log('encrypted', encrypted);
        console.log('decrypted', decrypted);
        console.groupEnd();
      })();
    </script>
  </body>
</html>
